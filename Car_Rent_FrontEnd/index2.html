<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cars</title>
    <link href="assets/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/css/home.css" rel="stylesheet">
    <link href="https://fonts.gstatic.com" rel="preconnect">
    <link href="https://fonts.googleapis.com/css2?family=Lobster&display=swap" rel="stylesheet">
</head>
<body>
<h1 class="navbar navbar-light" id="pickCar" style="background-color: #64d9f1">Unbeatable Price </br>
    <!--    <h2 class="navbar navbar-light" id="pickCar1">Rent-A-Car Experts</h2>-->
</h1>
<h3></h3>
<!--<hr>-->
<h6 id="carDetails">To Pick a Car Select on the Table</h6>

<section>
    <div class="col-md-6">
        <table class="table table-hover table-bordered shadow-sm" id="table">
            <thead class="bg-info text-dark">
            <tr>
                <th>Register No</th>
                <th>Brand</th>
                <th>Type</th>
                <th>No of Passenger</th>
                <th>Transmission Type</th>
                <th>Fuel Type</th>
                <th>Duration</th>
                <th>Color</th>
                <th>Price(Extra KM)</th>
                <th>Loose Damage</th>
                <th>Free Miliege For Price</th>

            </tr>
            </thead>
            <tbody id="tbody">

            </tbody>
        </table>
    </div>
    <div id="btnDiv">
        <button class="btn btn-primary" id="btnLoadAll" type="button">Load all Cars</button>
    </div>

</section>

<section class="shadow-lg" id="carPick">

    <nav class="navbar navbar-dark bg-success shadow-lg mb-3">
        <div class="container-fluid">
            <span class="navbar-brand mb-0 h1">Your Car Details</span>
        </div>
    </nav>

    <div class="col" id="formDiv">
        <form>
            <div class="mb-3 carPickList">
                <h7>Register No : </h7>
                <h7 class="Fontcolor" id="hregisterNo"></h7>
            </div>
            <div class="mb-3 carPickList">
                <h7>Brand : </h7>
                <h7 class="Fontcolor" id="hbrand"></h7>
            </div>
            <div class="mb-3 carPickList">
                <h7>Type : </h7>
                <h7 class="Fontcolor" id="htype"></h7>
            </div>
            <div class="mb-3 carPickList">
                <h7>No of Passanger : </h7>
                <h7 class="Fontcolor" id="hpassenger"></h7>
            </div>
            <div class="mb-3 carPickList">
                <h7>Transmission Type : </h7>
                <h7 class="Fontcolor" id="htransmissionType"></h7>
            </div>
            <div class="mb-3 carPickList">
                <h7>Fuel Type : </h7>
                <h7 class="Fontcolor" id="hfuelType"></h7>
            </div>
            <div class="mb-3 carPickList">
                <h7>Duration : </h7>
                <h7 class="Fontcolor" id="hduration"></h7>
            </div>
            <div class="mb-3 carPickList">
                <h7>Color : </h7>
                <h7 class="Fontcolor" id="hcolor"></h7>
            </div>
            <div class="mb-3 carPickList">
                <h7>Price(Extra KM) : </h7>
                <h7 class="Fontcolor" id="hpriceExKm"></h7>
            </div>
            <div class="mb-3 carPickList">
                <h7>Loose Damage : </h7>
                <h7 class="Fontcolor" id="hlooseDamage"></h7>
            </div>
            <div class="mb-3 carPickList">
                <h7>Free Miliege for Price : </h7>
                <h7 class="Fontcolor" id="hfreeMforPrice"></h7>
            </div>

            <hr>
            <h6 id="formTittle">Fill the Details</h6>
            <hr>
            <div class="mb-3 carPickList">
                <label class="form-label" for="startDate">Start Date</label>
                <input name="d" class="form-control" id="startDate" placeholder="" type="date">
            </div>
            <div class="mb-3 carPickList">
                <label class="form-label" for="endDate">End Date</label>
                <input name="d" class="form-control" id="endDate" placeholder="" type="date">
            </div>

            <label class="form-label carPickList">Rate</label>
            <div class="form-check carPickList">
                <input class="form-check-input" type="radio" value="dailyrate" name="flexRadioDefault" id="flexRadioDefault1">
                <label class="form-check-label" for="flexRadioDefault1">
                    Daily Rate
                </label>
            </div>
            <div class="form-check carPickList">
                <input class="form-check-input" type="radio" value="monthlyrate" name="flexRadioDefault" id="flexRadioDefault2" checked>
                <label class="form-check-label" for="flexRadioDefault2">
                    Monthly Rate
                </label>
            </div>
            <div class="mb-3 carPickList">
                <label class="form-label" for="cost">Cost</label>
                <input class="form-control" id="cost" name="cost" placeholder="" type="text">
            </div>
            <div class="mb-4 carPickList">
                <button class="btn btn-primary" id="btnPick" style="background-color: #0ff58a" type="button">Pick</button>
            </div>

        </form>
    </div>

</section>


<script src="assets/jquery-3.6.0.min.js"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script>

    loadAllCar();

    $("#btnLoadAll").click(function () {
        loadAllCar();

    })

    function loadAllCar() {
        $("#tbody").empty();

        $.ajax({
            method: "GET",
            url: "http://localhost:8081/carrent/api/v1/car",
            async: true,
            contentType: "application/json",
            success: function (data) {
                // let ob = JSON.parse(data);
                console.log(data);

                for (let cus of data) {
                    var row = `<tr><td>${cus.rno}</td><td>${cus.brand}</td><td>${cus.type}</td><td>${cus.passenger}</td><td>${cus.transmissiontype}</td>
                               <td>${cus.fueltype}</td><td>${cus.freeMforaduration}</td><td>${cus.color}</td><td>${cus.freeMforaPrice}</td><td>${cus.priceForextrakm}</td>
                               <td>${cus.lossdamage}</td></tr>`;
                    $("#tbody").append(row);

                    $('#tbody>tr').click(function () {
                        // console.log("ok")

                        let regNo = $($(this).children().get(0)).text();
                        let brand = $($(this).children().get(1)).text();
                        let type = $($(this).children().get(2)).text();
                        let passenger = $($(this).children().get(3)).text();
                        let transmissionType = $($(this).children().get(4)).text();
                        let fuelType = $($(this).children().get(5)).text();
                        let duration = $($(this).children().get(6)).text();
                        let color = $($(this).children().get(7)).text();
                        let priceForExkm = $($(this).children().get(8)).text();
                        let looseDamage = $($(this).children().get(9)).text();
                        let freeMFPrice = $($(this).children().get(10)).text();



                        $('#hregisterNo').text(regNo);
                        $('#hbrand').text(brand);
                        $('#htype').text(type);
                        $('#hpassenger').text(passenger);
                        $('#htransmissionType').text(transmissionType);
                        $('#hfuelType').text(fuelType);
                        $('#hduration').text(duration);
                        $('#hcolor').text(color);
                        $('#hpriceExKm').text(priceForExkm);
                        $('#hlooseDamage').text(looseDamage);
                        $('#hfreeMforPrice').text(freeMFPrice);

                    });

                }

            }

        })
    }

    // get rate from radio button
        function getRate(){
            document.getElementsByName('flexRadioDefault')
                .forEach(radio=>{
                    if (radio.checked){
                        var rate=radio.value;
                        console.log(rate);
                        return rate;
                    }
                });
        }

        // send rent data to the database
    $('#btnPick').click(function () {

        let startDate = $("#startDate").val();
        let endDate = $("#endDate").val();
        let cost = $("#cost").val();
        let duration = $('#hduration').val();
        let priceEx = $('hpriceExKm').val();
        getRate()


        $.ajax({
            url: 'http://localhost:8081/carrent/api/v1/rent',
            method: 'post',
            async: true,
            contentType: "application/json",
            data: JSON.stringify({

                // add id(auto genarate)

                startDate: startDate,
                endDate: endDate,
                duration: duration,
                cost: cost,
                extrakm: priceEx,
                getRate:getRate()

            }),
            success: function (data, responseState, xhr) {
                console.log(data);

            }
        })
    })


</script>
</body>
</html>